import requests
import re
import base64

def test_base64_strings(base_url, chat_endpoint):
    # Palabras clave o preguntas para interactuar con el chatbot
    interactions = [
        "hello",
        "help",
        "info",
        "details",
        "account"
    ]
    
    base64_pattern = r'([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)?'
    
    for interaction in interactions:
        # Enviar el mensaje al endpoint del chatbot
        response = requests.post(base_url + chat_endpoint, data={'message': interaction})
        content = response.content.decode('utf-8')
        
        # Buscar potenciales cadenas en Base64
        matches = re.findall(base64_pattern, content)
        
        for match in matches:
            try:
                decoded_string = base64.b64decode(match[0]).decode('utf-8')
                print(f"Potential Base64 string found: {match[0]}")
                print(f"Decoded string: {decoded_string}")
            except:
                pass

# Ejemplo de uso
# base_url = "http://example.com"
# chat_endpoint = "/api/chat"
# test_base64_strings(base_url, chat_endpoint)
